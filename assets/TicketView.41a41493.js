import{j as t,m as _,u as i,F as c,D as p,k as u,q as o,N as m,x as D,o as C,ah as B,r as V,n as l,y as v,K as F,M as L,z as N,ag as M,V as j,a9 as T,_ as q,a4 as A,l as Y,U as I,g as U,aa as z,ai as H,a1 as K,a2 as O,a8 as G}from"./index.565e4036.js";import{_ as $}from"./Tag.30fe1c75.js";import{_ as w}from"./Tag.92d9dc0e.js";import{_ as J}from"./SpinLoading.9cbb0707.js";import{F as P}from"./vee-validate.esm.94ff9ed5.js";import{c as Q,a as W}from"./object.9e6d0535.js";import{_ as X}from"./TextAreaInput.vue_vue_type_script_setup_true_lang.ac10752f.js";const Z={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},ee=c(" Administrador "),te=c(" Cliente "),se={class:"text-gray-700 text-base break-words"},ae={__name:"TicketResposta",props:{resposta:{type:Object,required:!0}},setup(a){return(f,h)=>(t(),_("div",{class:D(["block p-6 mb-3 rounded-lg shadow-lg bg-white",{nova:a.resposta.nova}])},[i("h5",Z,[c(p(a.resposta.administrador?a.resposta.administrador.nome:a.resposta.cliente.nome)+" ",1),a.resposta.administrador?(t(),u(w,{key:0,customColor:"amber",class:"ml-2"},{default:o(()=>[ee]),_:1})):m("",!0),a.resposta.cliente?(t(),u(w,{key:1,customColor:"purple",class:"ml-2"},{default:o(()=>[te]),_:1})):m("",!0)]),i("p",se,p(a.resposta.mensagem),1)],2))}},oe={class:""},re={class:""},ne={class:"flex items-center"},ie=c(" Enviar "),ce={key:0,class:"text-red-700 mt-3 mb-0"},le={__name:"ModalCreateResposta",props:{ticket:{type:Object,required:!0},modelValue:{type:Boolean,default:!1},idTicket:{type:Number,required:!0}},emits:["update:modelValue","scrollToResposta"],setup(a,{emit:f}){const h=a,e=Q().shape({mensagem:W().required("Mensagem n\xE3o informada").min(20,"Mensagem deve ter pelo menos 20 caracteres").max(500,"Mensagem deve ter no m\xE1ximo 500 caracteres.")}),R=()=>{f("update:modelValue",!1)},k=n=>{n.key==="Escape"&&R()};C(()=>{document.addEventListener("keyup",k)}),B(()=>{document.removeEventListener("keyup",k)});let r=V(!1);async function d(n,{resetForm:x,setErrors:s}){s({}),r.value=!0;const g=N(),y=M(),E={idTicket:h.idTicket,idAdministrador:g.user.idAdministrador,idCliente:g.user.idCliente,mensagem:n.mensagem};y.postResposta(E).then(b=>{const S={...b.data,nova:!0};h.ticket.respostas.push(S),x(),j(()=>{f("scrollToResposta",b.data.idResposta)})}).catch(b=>s({apiError:b})).finally(()=>r.value=!1)}return(n,x)=>{const s=J,g=T;return t(),_("div",oe,[i("div",re,[l(v(P),{onSubmit:d,"validation-schema":v(e)},{default:o(({errors:y})=>[l(X,{name:"mensagem",type:"text",label:"Mensagem",placeholder:"Mensagem",rows:3,class:"mb-4"}),l(g,{disabled:v(r)},{default:o(()=>[i("div",ne,[F(l(s,{class:"mr-3"},null,512),[[L,v(r)]]),ie])]),_:1},8,["disabled"]),y.apiError?(t(),_("div",ce,p(y.apiError),1)):m("",!0)]),_:1},8,["validation-schema"])])])}}};const de={class:"block p-6 shadow-lg bg-white"},me=c(" < Voltar "),ue={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},_e=c(" Encerrado "),pe=c(" Em aberto "),fe={class:"text-sm"},he={class:"text-gray-700 text-base mb-4"},ve=c(" Responder "),ke={key:0,class:"flex flex-col justify-center p-6 pb-0"},xe={class:"flex flex-col justify-center p-6"},ge={__name:"TicketView",emits:["closeMenu"],setup(a){const f=M(),h=A(),e=V({});C(async()=>{f.getTicket(h.params.id).then(d=>{e.value=d.data})});function R(d){document.getElementById("ticket-resposta-"+d).scrollIntoView({behavior:"smooth"})}const k=Y(()=>e.value.dataCriacao?K(e.value.dataCriacao,"DD/MM/YYYY HH:mm").value:""),r=I({createResposta:!1});return(d,n)=>{const x=U("RouterLink");return t(),_("div",null,[i("div",de,[l(x,{to:"/tickets"},{default:o(()=>[l(T,{class:"mb-5"},{default:o(()=>[me]),_:1})]),_:1}),i("h5",ue,[c(p(e.value.assunto)+" ",1),e.value.situacao===1?(t(),u($,{key:0,customColor:"green",class:"ml-2"},{default:o(()=>[_e]),_:1})):m("",!0),e.value.situacao===0?(t(),u($,{key:1,customColor:"blue",class:"ml-2"},{default:o(()=>[pe]),_:1})):m("",!0)]),i("p",fe,p(v(k)),1),i("p",he,p(e.value.descricao),1),e.value.situacao===0?(t(),u(T,{key:0,onClick:n[0]||(n[0]=z(s=>r.createResposta=!0,["prevent"])),class:"mb-2"},{default:o(()=>[ve]),_:1})):m("",!0)]),r.createResposta?(t(),_("div",ke,[l(le,{modelValue:r.createResposta,"onUpdate:modelValue":n[1]||(n[1]=s=>r.createResposta=s),onScrollToResposta:R,ticket:e.value,idTicket:e.value.idTicket},null,8,["modelValue","ticket","idTicket"])])):m("",!0),i("div",xe,[l(H,{name:"resposta"},{default:o(()=>[(t(!0),_(O,null,G(e.value.respostas,s=>(t(),u(ae,{key:s.idResposta,resposta:s,id:"ticket-resposta-"+s.idResposta},null,8,["resposta","id"]))),128))]),_:1})])])}}},Ve=q(ge,[["__scopeId","data-v-8718a8a4"]]);export{Ve as default};
