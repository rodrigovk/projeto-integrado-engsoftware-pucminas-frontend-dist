import{af as $,a4 as G,a5 as M,r as v,H as T,o as q,w as H,V as I,g as K,j as g,m as B,u as l,n as a,q as s,K as b,M as k,y as t,N as y,a3 as L,a9 as x,k as R,D as z,F as f}from"./index.565e4036.js";import{_ as J}from"./SpinLoading.9cbb0707.js";import{F as O}from"./vee-validate.esm.94ff9ed5.js";import{_ as D}from"./Tag.30fe1c75.js";import{_ as N}from"./TextInput.vue_vue_type_script_setup_true_lang.0243acda.js";const P={key:0,class:"block p-6 shadow-lg bg-white"},Q={class:"mb-5"},U=f(" < Voltar "),W=f(" Criar administrador "),X={class:"mb-2"},Y=f(" Ativo "),Z=f(" Inativo "),ee={class:""},ae={class:"flex"},se={class:"flex items-center"},te=f(" Gravando... "),oe={key:0,class:"text-red-700 mt-3 mb-0"},ce={__name:"AdministradorView",setup(ie){const E=$(),h=G(),j=M(),o=v({}),A=v(null),p=v(!0),d=T(()=>h.params.id===void 0);q(async()=>{C()}),H(()=>h.params,(m,e)=>{C()},{deep:!0});async function C(){p.value=!0,h.params.id?E.getAdministrador(h.params.id).then(m=>{const e=m.data;o.value={idAdministrador:e.idAdministrador,nome:e.nome,email:e.usuario.email,senha:""},p.value=!1}):(o.value={usuario:{}},I(()=>{A.value&&A.value.resetForm()}),p.value=!1)}let i=v(!1);function F(m,{setFieldError:e,setErrors:n,resetForm:V}){n({});const c=$(),{nome:S,email:w,senha:u}=m;let _=0;if(S.length===0&&(e("nome","Nome n\xE3o informado."),_++),w.length===0&&(e("email","E-mail n\xE3o informado."),_++),d.value?u.length===0&&(e("senha","Senha n\xE3o informada."),_++):u.length!==0&&u.length<8&&(e("senha","Senha deve ter pelo menos 8 caract\xE9res."),_++),!(_>0))return i.value=!0,d.value?c.postAdministrador(S,w,u).then(r=>{L({group:"ok",title:"Administrador criado com sucesso."}),j.push(`/administradores/${r.data.idAdministrador}`)}).catch(r=>n({apiError:r})).finally(()=>i.value=!1):c.putAdministrador(o.value.idAdministrador,S,w,u).then(r=>{L({group:"ok",title:"Administrador alterado com sucesso."})}).catch(r=>n({apiError:r})).finally(()=>i.value=!1)}return(m,e)=>{const n=K("RouterLink"),V=J;return p.value?y("",!0):(g(),B("div",P,[l("div",Q,[a(n,{to:"/administradores"},{default:s(()=>[a(x,{class:"mr-2"},{default:s(()=>[U]),_:1})]),_:1}),b(a(n,{to:{name:"administrador_novo"}},{default:s(()=>[a(x,{class:""},{default:s(()=>[W]),_:1})]),_:1},512),[[k,!t(d)]])]),a(t(O),{onSubmit:F,"initial-values":o.value,ref_key:"form",ref:A},{default:s(({errors:c})=>[a(N,{name:"nome",type:"text",label:"Nome",placeholder:"Nome",class:"mb-2"}),b(l("div",X,[o.value.situacao===1?(g(),R(D,{key:0,customColor:"green"},{default:s(()=>[Y]),_:1})):y("",!0),o.value.situacao===0?(g(),R(D,{key:1,customColor:"orange"},{default:s(()=>[Z]),_:1})):y("",!0)],512),[[k,!t(d)]]),a(N,{name:"email",type:"email",label:"E-mail",placeholder:"Endere\xE7o de e-mail",class:"mb-2"}),a(N,{name:"senha",type:"password",label:t(d)?"Senha":"Senha (preencher apenas caso deseje trocar a senha)",autocomplete:"new-password",placeholder:"Senha",class:"mb-4"},null,8,["label"]),l("div",ee,[a(x,{disabled:t(i)},{default:s(()=>[b(l("div",ae,[l("div",se,[a(V,{class:"mr-2"}),te])],512),[[k,t(i)]]),b(l("div",null," Gravar ",512),[[k,!t(i)]])]),_:1},8,["disabled"])]),c.apiError?(g(),B("div",oe,z(c.apiError),1)):y("",!0)]),_:1},8,["initial-values"])]))}}};export{ce as default};
