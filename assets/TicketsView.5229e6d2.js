import{g as V,o as a,c as u,a as o,n as S,e,K as L,L as E,r as T,x as q,M as j,m as v,t as x,N as y,j as f,k as p,f as h,_ as C,w as g,v as b,h as z,i as H,d as N,O as Y,u as F,C as I,P as D,Q as K}from"./index.7e36d01e.js";import{u as O,_ as A,a as U,b as P}from"./TextAreaInput.vue_vue_type_script_setup_true_lang.86c93ff8.js";import{_ as B}from"./SpinLoading.4f55b4a7.js";import{u as Q,c as W,a as M,F as G}from"./object.fa4ec820.js";const J={class:"flex items-center"},X={class:"-m-1"},Z=o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),ee=o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),te=[Z,ee],R={__name:"SpinLoading",props:{height:{type:Number,default:5},width:{type:Number,default:5},color:{type:String,default:"text-white"}},setup(t){const i=t,r=V(()=>({4:"h-4",5:"h-5",6:"h-6",7:"h-7",8:"h-8",9:"h-9",10:"h-10"})[i.height]),n=V(()=>({4:"w-4",5:"w-5",6:"w-6",7:"w-7",8:"w-8",9:"w-9",10:"w-10"})[i.width]);return(s,m)=>(a(),u("div",J,[o("div",X,[(a(),u("svg",{class:S(["animate-spin",[e(r),e(n),i.color]]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},te,2))])]))}},se={class:"block p-6 mb-3 rounded-lg shadow-lg bg-white"},ae={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},oe=v(" Encerrado "),re=v(" Em aberto "),ie={class:"text-sm"},ce={class:"text-gray-700 text-base mb-4"},ne={class:"flex"},le=v(" Visualizar "),de={class:"flex items-center"},ue=v(" Encerrar "),me={class:"flex items-center"},he=v(" Reabrir "),_e={__name:"Ticket",props:{ticket:{type:Object,required:!0}},setup(t){const i=t;L();const r=E();let n=T(!1),s=T(!1);const m=q(()=>O(i.ticket.dataCriacao,"DD-MM-YYYY HH:mm").value),c=()=>{n.value=!0,r.putTicketSituacao(i.ticket.idTicket,1).then(l=>i.ticket.situacao=1).catch(l=>setErrors({apiError:l})).finally(()=>n.value=!1)},k=()=>{s.value=!0,r.putTicketSituacao(i.ticket.idTicket,0).then(l=>i.ticket.situacao=0).catch(l=>setErrors({apiError:l})).finally(()=>s.value=!1)};return(l,d)=>{const _=j("RouterLink");return a(),u("div",se,[o("h5",ae,[v(x(t.ticket.assunto)+" ",1),t.ticket.situacao===1?(a(),y(A,{key:0,customColor:"green"},{default:f(()=>[oe]),_:1})):p("",!0),t.ticket.situacao===0?(a(),y(A,{key:1,customColor:"blue"},{default:f(()=>[re]),_:1})):p("",!0)]),o("p",ie,x(e(m)),1),o("p",ce,x(t.ticket.descricao),1),o("div",ne,[h(_,{to:{name:"ticket",params:{id:t.ticket.idTicket}},class:"card-footer-item"},{default:f(()=>[h(C,{class:"mr-2"},{default:f(()=>[le]),_:1})]),_:1},8,["to"]),t.ticket.situacao===0?(a(),y(C,{key:0,customColor:"green",onClick:c},{default:f(()=>[o("div",de,[g(h(B,{class:"mr-3"},null,512),[[b,e(n)]]),ue])]),_:1})):p("",!0),t.ticket.situacao===1?(a(),y(C,{key:1,customColor:"blue",onClick:k},{default:f(()=>[o("div",me,[g(h(B,{class:"mr-3"},null,512),[[b,e(s)]]),he])]),_:1})):p("",!0)])])}}},fe=["for"],pe=["name","id","type","value","placeholder"],ke=z({__name:"TextInput",props:{type:{type:String,default:"text"},value:{type:String,default:""},name:{type:String,required:!0},label:{type:String,required:!0},successMessage:{type:String,default:""},placeholder:{type:String,default:""}},setup(t){const i=t,r=H(i,"name"),{value:n,errorMessage:s,handleBlur:m,handleChange:c,meta:k}=Q(r,void 0,{initialValue:i.value});return(l,d)=>(a(),u("div",{class:S(["flex flex-col",{"has-error":!!e(s),success:e(k).valid}])},[o("label",{for:e(r)},x(t.label),9,fe),o("input",{name:e(r),id:e(r),type:t.type,value:e(n),placeholder:t.placeholder,onInput:d[0]||(d[0]=(..._)=>e(c)&&e(c)(..._)),onBlur:d[1]||(d[1]=(..._)=>e(m)&&e(m)(..._)),class:S(["rounded-md border-2 border-transparent outline-none transition duration-300 ease-in-out focus:outline-none focus:ring-0 placeholder:italic",{"bg-slate-200 focus:border-teal-500":!e(s),"bg-red-200 focus:border-red-500 text-red-700 placeholder:text-red-500":!!e(s)}])},null,42,pe),g(o("p",{class:"text-red-500"},x(e(s)),513),[[b,e(s)]]),g(o("p",{class:"text-green-500"},x(t.successMessage),513),[[b,e(k).valid]])],2))}}),xe={class:"block p-6 shadow-lg bg-white"},ve={class:""},ye={class:"flex items-center"},ge=v(" Criar ticket "),be={key:0,class:"text-red-700 mt-3 mb-0"},we={__name:"ModalCreateTicket",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:i}){const r=W().shape({assunto:M().required("Assunto n\xE3o informado").min(10,"Assunto deve ter pelo menos 10 caracteres").max(100,"Assunto deve ter no m\xE1ximo 100 caracteres."),descricao:M().required("Descri\xE7\xE3o n\xE3o informada").min(20,"Descri\xE7\xE3o deve ter pelo menos 20 caracteres").max(500,"Descri\xE7\xE3o deve ter no m\xE1ximo 500 caracteres.")});L();const n=c=>{c.key};N(()=>{document.addEventListener("keyup",n)}),Y(()=>{document.removeEventListener("keyup",n)});let s=T(!1);async function m(c,{resetForm:k,setErrors:l}){s.value=!0;try{const d=F(),_=E(),w={assunto:c.assunto,descricao:c.descricao};d.user.isAdministrador?w.idAdministrador=d.user.idAdministrador:w.idCliente=d.user.idCliente,await _.postTicket(w).then($=>{_.tickets.unshift($.data),k()}).catch($=>l({apiError:$}))}finally{s.value=!1}}return(c,k)=>{const l=P;return a(),u("div",xe,[o("div",ve,[h(e(G),{onSubmit:m,"validation-schema":e(r)},{default:f(({errors:d})=>[h(ke,{name:"assunto",type:"text",label:"Assunto",placeholder:"Assunto",class:"mb-2"}),h(U,{name:"descricao",type:"text",label:"Descri\xE7\xE3o",placeholder:"Descri\xE7\xE3o",rows:3,class:"mb-4"}),h(l,{disabled:e(s)},{default:f(()=>[o("div",ye,[g(h(R,{class:"mr-3"},null,512),[[b,e(s)]]),ge])]),_:1},8,["disabled"]),d.apiError?(a(),u("div",be,x(d.apiError),1)):p("",!0)]),_:1},8,["validation-schema"])])])}}},$e={class:"h-full"},Ce={key:0,class:"h-full flex flex-row justify-center items-center"},Se={class:"flex items-center"},Te=o("p",{class:"text-xl text-teal-600"}," Carregando... ",-1),Ee={key:0,class:"mb-0"},Ve={class:"flex flex-col justify-center p-6"},De={key:1,class:"text-xl px-6 py-6"},Ne={__name:"TicketsView",setup(t){const i=F(),r=E();N(()=>{r.init()});const n=I({createTicket:!0});return(s,m)=>(a(),u("div",$e,[e(r).ticketsLoaded?(a(),u(D,{key:1},[e(i).user.isAdministrador?p("",!0):(a(),u("div",Ee,[n.createTicket?(a(),y(we,{key:0,modelValue:n.createTicket,"onUpdate:modelValue":m[0]||(m[0]=c=>n.createTicket=c)},null,8,["modelValue"])):p("",!0)])),o("div",Ve,[(a(!0),u(D,null,K(e(r).tickets,c=>(a(),y(_e,{key:c.idTicket,ticket:c},null,8,["ticket"]))),128))]),e(r).tickets.length?p("",!0):(a(),u("div",De," N\xE3o h\xE1 nenhum ticket de suporte. "))],64)):(a(),u("div",Ce,[o("div",Se,[h(R,{height:8,width:8,color:"text-teal-600",class:"mr-3"}),Te])]))]))}};export{Ne as default};
