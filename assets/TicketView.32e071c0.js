import{l as w,a1 as V,j as t,m as v,u as r,G as c,D as _,k as f,q as o,E as u,y as h,x as B,o as M,ah as F,r as D,n as l,M as L,N,z as j,ag as E,V as q,a9 as T,_ as A,a4 as H,U as I,g as U,aa as z,ai as G,a2 as O,a8 as K}from"./index.038c8212.js";import{_ as $}from"./Tag.a1ed9073.js";import{_ as C}from"./Tag.6d28a408.js";import{_ as J}from"./SpinLoading.3f6d8973.js";import{F as P}from"./vee-validate.esm.894363cd.js";import{c as Q,a as W}from"./object.eab41036.js";import{_ as X}from"./TextAreaInput.vue_vue_type_script_setup_true_lang.1b074aff.js";const Z={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},ee=c(" Administrador "),te=c(" Cliente "),se={class:"text-sm"},ae={class:"text-gray-700 text-base break-words"},oe={__name:"TicketResposta",props:{resposta:{type:Object,required:!0}},setup(s){const d=s,p=w(()=>d.resposta?V(d.resposta.dataCriacao,"DD/MM/YYYY HH:mm").value:"");return(e,k)=>(t(),v("div",{class:B(["block p-6 mb-3 rounded-lg shadow-lg bg-white",{nova:s.resposta.nova}])},[r("h5",Z,[c(_(s.resposta.administrador?s.resposta.administrador.nome:s.resposta.cliente.nome)+" ",1),s.resposta.administrador?(t(),f(C,{key:0,customColor:"amber",class:"ml-2"},{default:o(()=>[ee]),_:1})):u("",!0),s.resposta.cliente?(t(),f(C,{key:1,customColor:"purple",class:"ml-2"},{default:o(()=>[te]),_:1})):u("",!0)]),r("p",se,_(h(p)),1),r("p",ae,_(s.resposta.mensagem),1)],2))}},re={class:""},ne={class:""},ie={class:"flex items-center"},ce=c(" Enviar "),le={key:0,class:"text-red-700 mt-3 mb-0"},de={__name:"ModalCreateResposta",props:{ticket:{type:Object,required:!0},modelValue:{type:Boolean,default:!1},idTicket:{type:Number,required:!0}},emits:["update:modelValue","scrollToResposta"],setup(s,{emit:d}){const p=s,e=Q().shape({mensagem:W().required("Mensagem n\xE3o informada").min(20,"Mensagem deve ter pelo menos 20 caracteres").max(500,"Mensagem deve ter no m\xE1ximo 500 caracteres.")}),k=()=>{d("update:modelValue",!1)},x=i=>{i.key==="Escape"&&k()};M(()=>{document.addEventListener("keyup",x)}),F(()=>{document.removeEventListener("keyup",x)});let n=D(!1);async function m(i,{resetForm:g,setErrors:a}){a({}),n.value=!0;const y=j(),b=E(),S={idTicket:p.idTicket,idAdministrador:y.user.idAdministrador,idCliente:y.user.idCliente,mensagem:i.mensagem};b.postResposta(S).then(R=>{const Y={...R.data,nova:!0};p.ticket.respostas.push(Y),g(),q(()=>{d("scrollToResposta",R.data.idResposta)})}).catch(R=>a({apiError:R})).finally(()=>n.value=!1)}return(i,g)=>{const a=J,y=T;return t(),v("div",re,[r("div",ne,[l(h(P),{onSubmit:m,"validation-schema":h(e)},{default:o(({errors:b})=>[l(X,{name:"mensagem",type:"text",label:"Mensagem",placeholder:"Mensagem",rows:3,class:"mb-4"}),l(y,{disabled:h(n)},{default:o(()=>[r("div",ie,[L(l(a,{class:"mr-3"},null,512),[[N,h(n)]]),ce])]),_:1},8,["disabled"]),b.apiError?(t(),v("div",le,_(b.apiError),1)):u("",!0)]),_:1},8,["validation-schema"])])])}}};const me={class:"h-full"},ue={class:"block p-6 shadow-lg bg-white"},_e=c(" < Voltar "),pe={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},fe=c(" Encerrado "),he=c(" Em aberto "),ve={class:"text-sm"},ke={class:"text-gray-700 text-base mb-4"},xe=c(" Responder "),ge={key:0,class:"flex flex-col justify-center p-6 pb-0"},ye={class:"flex flex-col justify-center p-6"},be={__name:"TicketView",emits:["closeMenu"],setup(s){const d=E(),p=H(),e=D({});M(async()=>{d.getTicket(p.params.id).then(m=>{e.value=m.data})});function k(m){document.getElementById("ticket-resposta-"+m).scrollIntoView({behavior:"smooth"})}const x=w(()=>e.value.dataCriacao?V(e.value.dataCriacao,"DD/MM/YYYY HH:mm").value:""),n=I({createResposta:!1});return(m,i)=>{const g=U("RouterLink");return t(),v("div",me,[r("div",ue,[l(g,{to:"/tickets"},{default:o(()=>[l(T,{class:"mb-5"},{default:o(()=>[_e]),_:1})]),_:1}),r("h5",pe,[c(_(e.value.assunto)+" ",1),e.value.situacao===1?(t(),f($,{key:0,customColor:"green",class:"ml-2"},{default:o(()=>[fe]),_:1})):u("",!0),e.value.situacao===0?(t(),f($,{key:1,customColor:"blue",class:"ml-2"},{default:o(()=>[he]),_:1})):u("",!0)]),r("p",ve,_(h(x)),1),r("p",ke,_(e.value.descricao),1),e.value.situacao===0?(t(),f(T,{key:0,onClick:i[0]||(i[0]=z(a=>n.createResposta=!0,["prevent"])),class:"mb-2"},{default:o(()=>[xe]),_:1})):u("",!0)]),n.createResposta?(t(),v("div",ge,[l(de,{modelValue:n.createResposta,"onUpdate:modelValue":i[1]||(i[1]=a=>n.createResposta=a),onScrollToResposta:k,ticket:e.value,idTicket:e.value.idTicket},null,8,["modelValue","ticket","idTicket"])])):u("",!0),r("div",ye,[l(G,{name:"resposta"},{default:o(()=>[(t(!0),v(O,null,K(e.value.respostas,a=>(t(),f(oe,{key:a.idResposta,resposta:a,id:"ticket-resposta-"+a.idResposta},null,8,["resposta","id"]))),128))]),_:1})])])}}},De=A(be,[["__scopeId","data-v-5d90688e"]]);export{De as default};
