import{l as w,a1 as V,j as t,m as v,u as r,G as c,D as _,k as f,q as o,E as u,y as h,x as B,o as M,ah as F,r as D,n as l,M as L,N,z as j,ag as E,V as q,a9 as T,_ as A,a4 as H,U as I,g as U,aa as z,ai as G,a2 as O,a8 as K}from"./index.7ebe12a4.js";import{_ as $}from"./Tag.d8d54b71.js";import{_ as C}from"./Tag.8b072a30.js";import{_ as J}from"./SpinLoading.9e4e8f31.js";import{F as P}from"./vee-validate.esm.ba1d6d91.js";import{c as Q,a as W}from"./object.5aedc21a.js";import{_ as X}from"./TextAreaInput.vue_vue_type_script_setup_true_lang.07939dba.js";const Z={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},ee=c(" Administrador "),te=c(" Cliente "),ae={class:"text-sm"},se={class:"text-gray-700 text-base break-words"},oe={__name:"TicketResposta",props:{resposta:{type:Object,required:!0}},setup(a){const d=a,p=w(()=>d.resposta?V(d.resposta.dataCriacao,"DD/MM/YYYY HH:mm").value:"");return(e,k)=>(t(),v("div",{class:B(["block p-6 mb-3 rounded-lg shadow-lg bg-white",{nova:a.resposta.nova}])},[r("h5",Z,[c(_(a.resposta.administrador?a.resposta.administrador.nome:a.resposta.cliente.nome)+" ",1),a.resposta.administrador?(t(),f(C,{key:0,customColor:"amber",class:"ml-2"},{default:o(()=>[ee]),_:1})):u("",!0),a.resposta.cliente?(t(),f(C,{key:1,customColor:"purple",class:"ml-2"},{default:o(()=>[te]),_:1})):u("",!0)]),r("p",ae,_(h(p)),1),r("p",se,_(a.resposta.mensagem),1)],2))}},re={class:""},ne={class:""},ie={class:"flex items-center"},ce=c(" Enviar "),le={key:0,class:"text-red-700 mt-3 mb-0"},de={__name:"ModalCreateResposta",props:{ticket:{type:Object,required:!0},modelValue:{type:Boolean,default:!1},idTicket:{type:Number,required:!0}},emits:["update:modelValue","scrollToResposta"],setup(a,{emit:d}){const p=a,e=Q().shape({mensagem:W().required("Mensagem n\xE3o informada").min(20,"Mensagem deve ter pelo menos 20 caracteres").max(500,"Mensagem deve ter no m\xE1ximo 500 caracteres.")}),k=()=>{d("update:modelValue",!1)},x=i=>{i.key==="Escape"&&k()};M(()=>{document.addEventListener("keyup",x)}),F(()=>{document.removeEventListener("keyup",x)});let n=D(!1);async function m(i,{resetForm:g,setErrors:s}){s({}),n.value=!0;const y=j(),b=E(),S={idTicket:p.idTicket,idAdministrador:y.user.idAdministrador,idCliente:y.user.idCliente,mensagem:i.mensagem};b.postResposta(S).then(R=>{const Y={...R.data,nova:!0};p.ticket.respostas.push(Y),g(),q(()=>{d("scrollToResposta",R.data.idResposta)})}).catch(R=>s({apiError:R})).finally(()=>n.value=!1)}return(i,g)=>{const s=J,y=T;return t(),v("div",re,[r("div",ne,[l(h(P),{onSubmit:m,"validation-schema":h(e)},{default:o(({errors:b})=>[l(X,{name:"mensagem",type:"text",label:"Mensagem",placeholder:"Mensagem",rows:3,class:"mb-4"}),l(y,{disabled:h(n)},{default:o(()=>[r("div",ie,[L(l(s,{class:"mr-3"},null,512),[[N,h(n)]]),ce])]),_:1},8,["disabled"]),b.apiError?(t(),v("div",le,_(b.apiError),1)):u("",!0)]),_:1},8,["validation-schema"])])])}}};const me={class:"block p-6 shadow-lg bg-white"},ue=c(" < Voltar "),_e={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},pe=c(" Encerrado "),fe=c(" Em aberto "),he={class:"text-sm"},ve={class:"text-gray-700 text-base mb-4"},ke=c(" Responder "),xe={key:0,class:"flex flex-col justify-center p-6 pb-0"},ge={class:"flex flex-col justify-center p-6"},ye={__name:"TicketView",emits:["closeMenu"],setup(a){const d=E(),p=H(),e=D({});M(async()=>{d.getTicket(p.params.id).then(m=>{e.value=m.data})});function k(m){document.getElementById("ticket-resposta-"+m).scrollIntoView({behavior:"smooth"})}const x=w(()=>e.value.dataCriacao?V(e.value.dataCriacao,"DD/MM/YYYY HH:mm").value:""),n=I({createResposta:!1});return(m,i)=>{const g=U("RouterLink");return t(),v("div",null,[r("div",me,[l(g,{to:"/tickets"},{default:o(()=>[l(T,{class:"mb-5"},{default:o(()=>[ue]),_:1})]),_:1}),r("h5",_e,[c(_(e.value.assunto)+" ",1),e.value.situacao===1?(t(),f($,{key:0,customColor:"green",class:"ml-2"},{default:o(()=>[pe]),_:1})):u("",!0),e.value.situacao===0?(t(),f($,{key:1,customColor:"blue",class:"ml-2"},{default:o(()=>[fe]),_:1})):u("",!0)]),r("p",he,_(h(x)),1),r("p",ve,_(e.value.descricao),1),e.value.situacao===0?(t(),f(T,{key:0,onClick:i[0]||(i[0]=z(s=>n.createResposta=!0,["prevent"])),class:"mb-2"},{default:o(()=>[ke]),_:1})):u("",!0)]),n.createResposta?(t(),v("div",xe,[l(de,{modelValue:n.createResposta,"onUpdate:modelValue":i[1]||(i[1]=s=>n.createResposta=s),onScrollToResposta:k,ticket:e.value,idTicket:e.value.idTicket},null,8,["modelValue","ticket","idTicket"])])):u("",!0),r("div",ge,[l(G,{name:"resposta"},{default:o(()=>[(t(!0),v(O,null,K(e.value.respostas,s=>(t(),f(oe,{key:s.idResposta,resposta:s,id:"ticket-resposta-"+s.idResposta},null,8,["resposta","id"]))),128))]),_:1})])])}}},Me=A(ye,[["__scopeId","data-v-8718a8a4"]]);export{Me as default};
