import{j as V,o,c as u,b as t,n as w,h as e,N,O as E,f as T,B as F,r as j,i as v,t as x,P as y,w as f,s as p,a as h,q as S,m as g,v as b,k as z,l as H,g as L,Q as Y,u as R,R as U,G as I,S as A,U as O}from"./index.835fc0f1.js";import{u as G,_ as D,a as K}from"./TextAreaInput.vue_vue_type_script_setup_true_lang.a96ff031.js";import{_ as B}from"./SpinLoading.3bab6674.js";import{u as P,c as Q,a as M,F as W}from"./object.29ef8081.js";const J={class:"flex items-center"},X={class:"-m-1"},Z=t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),ee=t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),te=[Z,ee],q={__name:"SpinLoading",props:{height:{type:Number,default:5},width:{type:Number,default:5},color:{type:String,default:"text-white"}},setup(s){const r=s,i=V(()=>({4:"h-4",5:"h-5",6:"h-6",7:"h-7",8:"h-8",9:"h-9",10:"h-10"})[r.height]),n=V(()=>({4:"w-4",5:"w-5",6:"w-6",7:"w-7",8:"w-8",9:"w-9",10:"w-10"})[r.width]);return(a,m)=>(o(),u("div",J,[t("div",X,[(o(),u("svg",{class:w(["animate-spin",[e(i),e(n),r.color]]),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},te,2))])]))}},se={class:"block p-6 mb-3 rounded-lg shadow-lg bg-white"},ae={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},oe=v(" Encerrado "),re=v(" Em aberto "),ie={class:"text-sm"},ce={class:"text-gray-700 text-base mb-4"},ne={class:"flex"},le=v(" Visualizar "),de={class:"flex items-center"},ue=v(" Encerrar "),me={class:"flex items-center"},he=v(" Reabrir "),_e={__name:"Ticket",props:{ticket:{type:Object,required:!0}},setup(s){const r=s;N();const i=E();let n=T(!1),a=T(!1);const m=F(()=>G(r.ticket.dataCriacao,"DD-MM-YYYY HH:mm").value),c=()=>{n.value=!0,i.putTicketSituacao(r.ticket.idTicket,1).then(l=>r.ticket.situacao=1).catch(l=>setErrors({apiError:l})).finally(()=>n.value=!1)},k=()=>{a.value=!0,i.putTicketSituacao(r.ticket.idTicket,0).then(l=>r.ticket.situacao=0).catch(l=>setErrors({apiError:l})).finally(()=>a.value=!1)};return(l,d)=>{const _=j("RouterLink");return o(),u("div",se,[t("h5",ae,[v(x(s.ticket.assunto)+" ",1),s.ticket.situacao===1?(o(),y(D,{key:0,customColor:"green"},{default:f(()=>[oe]),_:1})):p("",!0),s.ticket.situacao===0?(o(),y(D,{key:1,customColor:"blue"},{default:f(()=>[re]),_:1})):p("",!0)]),t("p",ie,x(e(m)),1),t("p",ce,x(s.ticket.descricao),1),t("div",ne,[h(_,{to:{name:"ticket",params:{id:s.ticket.idTicket}},class:"card-footer-item"},{default:f(()=>[h(S,{class:"mr-2"},{default:f(()=>[le]),_:1})]),_:1},8,["to"]),s.ticket.situacao===0?(o(),y(S,{key:0,customColor:"green",onClick:c},{default:f(()=>[t("div",de,[g(h(B,{class:"mr-3"},null,512),[[b,e(n)]]),ue])]),_:1})):p("",!0),s.ticket.situacao===1?(o(),y(S,{key:1,customColor:"blue",onClick:k},{default:f(()=>[t("div",me,[g(h(B,{class:"mr-3"},null,512),[[b,e(a)]]),he])]),_:1})):p("",!0)])])}}},fe=["for"],pe=["name","id","type","value","placeholder"],ke=z({__name:"TextInput",props:{type:{type:String,default:"text"},value:{type:String,default:""},name:{type:String,required:!0},label:{type:String,required:!0},successMessage:{type:String,default:""},placeholder:{type:String,default:""}},setup(s){const r=s,i=H(r,"name"),{value:n,errorMessage:a,handleBlur:m,handleChange:c,meta:k}=P(i,void 0,{initialValue:r.value});return(l,d)=>(o(),u("div",{class:w(["flex flex-col",{"has-error":!!e(a),success:e(k).valid}])},[t("label",{for:e(i)},x(s.label),9,fe),t("input",{name:e(i),id:e(i),type:s.type,value:e(n),placeholder:s.placeholder,onInput:d[0]||(d[0]=(..._)=>e(c)&&e(c)(..._)),onBlur:d[1]||(d[1]=(..._)=>e(m)&&e(m)(..._)),class:w(["rounded-md border-2 border-transparent outline-none transition duration-300 ease-in-out focus:outline-none focus:ring-0 placeholder:italic",{"bg-slate-200 focus:border-teal-500":!e(a),"bg-red-200 focus:border-red-500 text-red-700 placeholder:text-red-500":!!e(a)}])},null,42,pe),g(t("p",{class:"text-red-500"},x(e(a)),513),[[b,e(a)]]),g(t("p",{class:"text-green-500"},x(s.successMessage),513),[[b,e(k).valid]])],2))}}),xe={class:"block p-6 shadow-lg bg-white"},ve={class:""},ye={class:"flex items-center"},ge=v(" Criar ticket "),be={key:0,class:"text-red-700 mt-3 mb-0"},we={__name:"ModalCreateTicket",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:r}){const i=Q().shape({assunto:M().required("Assunto n\xE3o informado").min(10,"Assunto deve ter pelo menos 10 caracteres").max(100,"Assunto deve ter no m\xE1ximo 100 caracteres."),descricao:M().required("Descri\xE7\xE3o n\xE3o informada").min(20,"Descri\xE7\xE3o deve ter pelo menos 20 caracteres").max(500,"Descri\xE7\xE3o deve ter no m\xE1ximo 500 caracteres.")});N();const n=c=>{c.key};L(()=>{document.addEventListener("keyup",n)}),Y(()=>{document.removeEventListener("keyup",n)});let a=T(!1);async function m(c,{resetForm:k,setErrors:l}){a.value=!0;try{const d=R(),_=E(),$={assunto:c.assunto,descricao:c.descricao};d.user.isAdministrador?$.idAdministrador=d.user.idAdministrador:$.idCliente=d.user.idCliente,await _.postTicket($).then(C=>{_.tickets.unshift(C.data),k()}).catch(C=>l({apiError:C}))}finally{a.value=!1}}return(c,k)=>{const l=U;return o(),u("div",xe,[t("div",ve,[h(e(W),{onSubmit:m,"validation-schema":e(i)},{default:f(({errors:d})=>[h(ke,{name:"assunto",type:"text",label:"Assunto",placeholder:"Assunto",class:"mb-2"}),h(K,{name:"descricao",type:"text",label:"Descri\xE7\xE3o",placeholder:"Descri\xE7\xE3o",rows:3,class:"mb-4"}),h(l,{disabled:e(a)},{default:f(()=>[t("div",ye,[g(h(q,{class:"mr-3"},null,512),[[b,e(a)]]),ge])]),_:1},8,["disabled"]),d.apiError?(o(),u("div",be,x(d.apiError),1)):p("",!0)]),_:1},8,["validation-schema"])])])}}},$e={class:"h-full"},Ce={key:0,class:"h-full flex flex-row justify-center items-center"},Se={class:"flex items-center"},Te=t("p",{class:"text-xl text-teal-600"}," Carregando... ",-1),Ee={key:0,class:"mb-0"},Ve={class:"flex flex-col justify-center p-6"},Ae={key:1,class:"text-xl px-6 py-6"},Le={__name:"TicketsView",setup(s){const r=R(),i=E();L(()=>{i.init()});const n=I({createTicket:!0});return(a,m)=>(o(),u("div",$e,[e(i).ticketsLoaded?(o(),u(A,{key:1},[t("div",{class:w(["text-2xl pt-6 pl-6",{"bg-white":!e(r).user.isAdministrador}])}," Tickets de suporte ",2),e(r).user.isAdministrador?p("",!0):(o(),u("div",Ee,[n.createTicket?(o(),y(we,{key:0,modelValue:n.createTicket,"onUpdate:modelValue":m[0]||(m[0]=c=>n.createTicket=c)},null,8,["modelValue"])):p("",!0)])),t("div",Ve,[(o(!0),u(A,null,O(e(i).tickets,c=>(o(),y(_e,{key:c.idTicket,ticket:c},null,8,["ticket"]))),128))]),e(i).tickets.length?p("",!0):(o(),u("div",Ae," N\xE3o h\xE1 nenhum ticket de suporte. "))],64)):(o(),u("div",Ce,[t("div",Se,[h(q,{height:8,width:8,color:"text-teal-600",class:"mr-3"}),Te])]))]))}};export{Le as default};
