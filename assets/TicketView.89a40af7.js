import{l as w,a1 as V,j as t,m as v,u as o,G as i,D as _,k as f,q as c,E as m,y as h,x as B,o as M,ah as F,r as D,n as u,M as L,N,z as j,ag as E,V as q,a9 as $,_ as A,a4 as H,U as I,g as U,aa as z,a2 as O,a8 as G}from"./index.da3217b1.js";import{_ as C}from"./Tag.106c7565.js";import{_ as T}from"./Tag.e44026d7.js";import{_ as K}from"./SpinLoading.61e49bbf.js";import{F as J}from"./vee-validate.esm.32bc4266.js";import{c as P,a as Q}from"./object.2c145288.js";import{_ as W}from"./TextAreaInput.vue_vue_type_script_setup_true_lang.bfeda6e4.js";const X={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},Z=i(" Administrador "),ee=i(" Cliente "),te={class:"text-sm"},se={class:"text-gray-700 text-base break-words"},ae={__name:"TicketResposta",props:{resposta:{type:Object,required:!0}},setup(s){const l=s,p=w(()=>l.resposta?V(l.resposta.dataCriacao,"DD/MM/YYYY HH:mm").value:"");return(e,k)=>(t(),v("div",{class:B(["block p-6 mb-3 rounded-lg shadow-lg bg-white",{nova:s.resposta.nova}])},[o("h5",X,[i(_(s.resposta.administrador?s.resposta.administrador.nome:s.resposta.cliente.nome)+" ",1),s.resposta.administrador?(t(),f(T,{key:0,customColor:"amber",class:"ml-2"},{default:c(()=>[Z]),_:1})):m("",!0),s.resposta.cliente?(t(),f(T,{key:1,customColor:"purple",class:"ml-2"},{default:c(()=>[ee]),_:1})):m("",!0)]),o("p",te,_(h(p)),1),o("p",se,_(s.resposta.mensagem),1)],2))}},oe={class:""},re={class:""},ne={class:"flex items-center"},ce=i(" Enviar "),ie={key:0,class:"text-red-700 mt-3 mb-0"},le={__name:"ModalCreateResposta",props:{ticket:{type:Object,required:!0},modelValue:{type:Boolean,default:!1},idTicket:{type:Number,required:!0}},emits:["update:modelValue","scrollToResposta"],setup(s,{emit:l}){const p=s,e=P().shape({mensagem:Q().required("Mensagem n\xE3o informada").min(20,"Mensagem deve ter pelo menos 20 caracteres").max(500,"Mensagem deve ter no m\xE1ximo 500 caracteres.")}),k=()=>{l("update:modelValue",!1)},x=n=>{n.key==="Escape"&&k()};M(()=>{document.addEventListener("keyup",x)}),F(()=>{document.removeEventListener("keyup",x)});let r=D(!1);async function d(n,{resetForm:g,setErrors:a}){a({}),r.value=!0;const b=j(),y=E(),S={idTicket:p.idTicket,idAdministrador:b.user.idAdministrador,idCliente:b.user.idCliente,mensagem:n.mensagem};y.postResposta(S).then(R=>{const Y={...R.data,nova:!0};p.ticket.respostas.push(Y),g(),q(()=>{l("scrollToResposta",R.data.idResposta)})}).catch(R=>a({apiError:R})).finally(()=>r.value=!1)}return(n,g)=>{const a=K,b=$;return t(),v("div",oe,[o("div",re,[u(h(J),{onSubmit:d,"validation-schema":h(e)},{default:c(({errors:y})=>[u(W,{name:"mensagem",type:"text",label:"Mensagem",placeholder:"Mensagem",rows:3,class:"mb-4"}),u(b,{disabled:h(r)},{default:c(()=>[o("div",ne,[L(u(a,{class:"mr-3"},null,512),[[N,h(r)]]),ce])]),_:1},8,["disabled"]),y.apiError?(t(),v("div",ie,_(y.apiError),1)):m("",!0)]),_:1},8,["validation-schema"])])])}}};const de={class:"h-full"},me={class:"block p-6 shadow-lg bg-white"},ue=i(" < Voltar "),_e={class:"flex flex-row items-center text-gray-900 text-xl leading-tight font-medium mb-2"},pe=i(" Encerrado "),fe=i(" Em aberto "),he={class:"text-sm"},ve={class:"text-gray-700 text-base mb-4"},ke=i(" Responder "),xe={key:0,class:"flex flex-col justify-center p-6 pb-0"},ge={class:"flex flex-col justify-center p-6"},be={__name:"TicketView",emits:["closeMenu"],setup(s){const l=E(),p=H(),e=D({});M(async()=>{l.getTicket(p.params.id).then(d=>{e.value=d.data})});function k(d){document.getElementById("ticket-resposta-"+d).scrollIntoView({behavior:"smooth"})}const x=w(()=>e.value.dataCriacao?V(e.value.dataCriacao,"DD/MM/YYYY HH:mm").value:""),r=I({createResposta:!1});return(d,n)=>{const g=U("RouterLink");return t(),v("div",de,[o("div",me,[u(g,{to:"/tickets"},{default:c(()=>[u($,{class:"mb-5"},{default:c(()=>[ue]),_:1})]),_:1}),o("h5",_e,[i(_(e.value.assunto)+" ",1),e.value.situacao===1?(t(),f(C,{key:0,customColor:"green",class:"ml-2"},{default:c(()=>[pe]),_:1})):m("",!0),e.value.situacao===0?(t(),f(C,{key:1,customColor:"blue",class:"ml-2"},{default:c(()=>[fe]),_:1})):m("",!0)]),o("p",he,_(h(x)),1),o("p",ve,_(e.value.descricao),1),e.value.situacao===0?(t(),f($,{key:0,onClick:n[0]||(n[0]=z(a=>r.createResposta=!0,["prevent"])),class:"mb-2"},{default:c(()=>[ke]),_:1})):m("",!0)]),r.createResposta?(t(),v("div",xe,[u(le,{modelValue:r.createResposta,"onUpdate:modelValue":n[1]||(n[1]=a=>r.createResposta=a),onScrollToResposta:k,ticket:e.value,idTicket:e.value.idTicket},null,8,["modelValue","ticket","idTicket"])])):m("",!0),o("div",ge,[(t(!0),v(O,null,G(e.value.respostas,a=>(t(),f(ae,{key:a.idResposta,resposta:a,id:"ticket-resposta-"+a.idResposta},null,8,["resposta","id"]))),128))])])}}},Me=A(be,[["__scopeId","data-v-419758fb"]]);export{Me as default};
